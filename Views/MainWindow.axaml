<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:FileExplorer.ViewModels"		
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
		xmlns:sys="clr-namespace:System;assembly=mscorlib"
		xmlns:i="clr-namespace:Avalonia.Xaml.Interactivity;assembly=Avalonia.Xaml.Interactivity"
		xmlns:ia="clr-namespace:Avalonia.Xaml.Interactions.Core;assembly=Avalonia.Xaml.Interactions"
		xmlns:local="clr-namespace:FileExplorer.ViewModels;assembly=FileExplorer"
        mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
        x:Class="FileExplorer.Views.MainWindow"
        Icon="/Assets/avalonia-logo.ico"
        Title="FileExplorer">
	<!--WindowState="Maximized"
		WindowStartupLocation="CenterScreen">-->	

	<Window.Title>
		<Binding Path="CurrentDirectoryItem.Name"/>
	</Window.Title>
	
	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="33"/>
			<RowDefinition Height="33"/>
			<RowDefinition Height="0.4*"/>
			<RowDefinition Height="*"/>
		</Grid.RowDefinitions>
		<Grid.ColumnDefinitions>
			<ColumnDefinition Width="80"/>
			<ColumnDefinition Width="80"/>
			<ColumnDefinition Width="80"/>
			<ColumnDefinition Width="*"/>
		</Grid.ColumnDefinitions>

		<!--Background-->
		<Border Grid.Row="2" Grid.RowSpan="2"
				Grid.Column="3" Grid.ColumnSpan="2"
				CornerRadius="3">
			<Border.Background>
				<ImageBrush Stretch="Fill" Opacity="0.8"
			   Source="/Assets/autumn.jpg"/>
			</Border.Background>
		</Border>		
		
		<!--Buttons-->
		<Grid Grid.Row="1" Grid.Column="0">
			<Button Content="&lt;-" Background="Coral"
					HorizontalAlignment="Stretch"
					HorizontalContentAlignment="Center"
					Command="{Binding CurrentDirectoryItem.MoveBackCommand}" />			
		</Grid>
		<Grid Grid.Row="1" Grid.Column="1">			
			<Button Content="⇧" Background="IndianRed"
					HorizontalAlignment="Stretch"
					HorizontalContentAlignment="Center"
					Command="{Binding CurrentDirectoryItem.MoveForwardCommand}" />			
		</Grid>
		
		<Grid Grid.Row="1" Grid.Column="2">
			<Button Content="-&gt;" Background="Coral"
					HorizontalAlignment="Stretch"
					HorizontalContentAlignment="Center"
					Command="{Binding CurrentDirectoryItem.MoveUpCommand}" />
		</Grid>		

		<Grid Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="4">
			<Menu>
				<MenuItem Header="Главная" HorizontalAlignment="Stretch"
						  Margin="0,0,2,0"
						  Background="PeachPuff" CornerRadius="3">
					<MenuItem Header="Открыть" 
							  Command="{Binding CurrentDirectoryItem.OpenCommand}"
							  CommandParameter="{Binding CurrentDirectoryItem.SelectFileEntity}"/>
					<MenuItem Header="Закрепить на панели быстрого доступа"
							  Command="{Binding QuickDirectoryItem.AddToQuickAccessCommand}"
							  CommandParameter="{Binding CurrentDirectoryItem.SelectFileEntity}"/>					
					<MenuItem Header="Копировать"/>
					<MenuItem Header="Вставить"/>
					<MenuItem Header="Вырезать"/>
					<MenuItem Header="Скопировать путь"/>
					<MenuItem Header="Переместить в"/>
					<MenuItem Header="Скопировать в"/>
					<MenuItem Header="Удалить"
							  Command="{Binding CurrentDirectoryItem.DeleteCommand}"
							  CommandParameter="{Binding CurrentDirectoryItem.SelectFileEntity}"/>
					<MenuItem Header="Переименовать"
							  Command="{Binding CurrentDirectoryItem.RenameCommand}"
							  CommandParameter="{Binding CurrentDirectoryItem.SelectFileEntity}"/>
					<MenuItem Header="Новая папка"/>
					<MenuItem Header="Свойства"/>
					<MenuItem Header="Выделить все"/>
					<MenuItem Header="Снять выделение"/>
					<MenuItem Header="Обратить выделение"/>
				</MenuItem>

				<MenuItem Header="Вид" HorizontalAlignment="Stretch"
						  Margin="2,0,0,0"
						  Background="PeachPuff" CornerRadius="3">
					<MenuItem Header="Область навигации"/>
					<MenuItem Header="Область сведений"/>
					<MenuItem Header="Вид">
						<MenuItem Header="Огромные значки"/>
						<MenuItem Header="Крупные значки"/>
						<MenuItem Header="Обычные значки"/>
						<MenuItem Header="Мелкие значки"/>
						<MenuItem Header="Список"/>
						<MenuItem Header="Плитка"/>
						<MenuItem Header="Таблица"/>
						<MenuItem Header="Содержимое"/>
					</MenuItem>
					<MenuItem Header="Сортировка">
						<MenuItem Header="Имя"/>
						<MenuItem Header="Дата изменения"/>
						<MenuItem Header="Тип"/>
						<MenuItem Header="Размер"/>
						<MenuItem Header="По возрастанию"/>
						<MenuItem Header="По убыванию"/>
					</MenuItem>
				</MenuItem>
			</Menu>
		</Grid>

		<TextBox Grid.Row="0" Grid.Column="4" Grid.ColumnSpan="3" 
				 Margin="2,5,0,5" Text="Поиск: "
				 Background="White" BorderThickness="0.5" 
				 BorderBrush="RosyBrown"/>
		
		<!--QuickAccess-->
		<ListBox Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3"
				 Items="{Binding QuickDirectoryItem.QuickAccessItems}"
				 Background="#FFE0D1">

			<i:Interaction.Behaviors>
				<ia:EventTriggerBehavior EventName="DoubleTapped">
					<ia:InvokeCommandAction
						Command="{Binding CurrentDirectoryItem.OpenCommand}"
						CommandParameter="{Binding CurrentDirectoryItem.SelectFileEntity}"/>
				</ia:EventTriggerBehavior>
			</i:Interaction.Behaviors>

			<ListBox.Resources>
				<local:FileEntityToImageConverter x:Key="FileEntityResource"/>
			</ListBox.Resources>
			
			<ListBox.ItemTemplate>
				<DataTemplate>
					<StackPanel Orientation="Horizontal">
						<DrawingPresenter Drawing="{Binding ., 
										  Converter={StaticResource FileEntityResource}}"
										  Width="35" Height="35"
										  HorizontalAlignment="Left"
										  VerticalAlignment="Center">
						</DrawingPresenter>
						<TextBlock Text="{Binding Name}" TextWrapping="Wrap"
								   VerticalAlignment="Center" FontSize="12"/>
					</StackPanel>
				</DataTemplate>
			</ListBox.ItemTemplate>
		</ListBox>
		
		<!--Tree View-->
		<!--Сделать углы через Border!-->
		<TreeView Name="tree" Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="3"
				  Items="{Binding TreeDirectoryItem.Items}"	
				  SelectedItem="{Binding TreeDirectoryItem.SelectFileEntity}"
				  Width="240" HorizontalAlignment="Left"
				  ScrollViewer.HorizontalScrollBarVisibility="Disabled"
				  Background="PapayaWhip" BorderBrush="RosyBrown" BorderThickness="0,1,0,0">
			<TreeView.ItemTemplate>
				<TreeDataTemplate ItemsSource="{Binding Subfolders}">
					<TextBlock Text="{Binding Name}" FontSize="14"
							   VerticalAlignment="Center" TextWrapping="Wrap"/>
				</TreeDataTemplate>
			</TreeView.ItemTemplate>
		</TreeView>
		
		<!---->
		
		<!--Main Panel-->
		<Border Grid.Row="1" Grid.Column="3" Grid.ColumnSpan="2"
				CornerRadius="3" Background="PapayaWhip" Margin="2,3,0,2"
				BorderThickness="0.5" BorderBrush="RosyBrown">
			<TextBlock Grid.Row="1" Grid.Column="3"  Grid.ColumnSpan="2"
				   Margin="5,0,0,0"
				   Text="{Binding CurrentDirectoryItem.FilePath}"
				   VerticalAlignment="Center" HorizontalAlignment="Center"/>
		</Border>

		<ListBox Grid.Row="2" Grid.RowSpan="2"
				 Grid.Column="3" Grid.ColumnSpan="2"
				 Background="Transparent"
				 Items="{Binding CurrentDirectoryItem.DirectoriesAndFiles}"
				 SelectedItem="{Binding CurrentDirectoryItem.SelectFileEntity}">	
			
			<i:Interaction.Behaviors>
				<ia:EventTriggerBehavior EventName="DoubleTapped">
					<ia:InvokeCommandAction
						Command="{Binding CurrentDirectoryItem.OpenCommand}"
						CommandParameter="{Binding CurrentDirectoryItem.SelectFileEntity}"/>
				</ia:EventTriggerBehavior>
			</i:Interaction.Behaviors>

			<ListBox.ContextMenu>
				<ContextMenu>
					<MenuItem Header="Вид">
						<MenuItem Header="Огромные значки"/>
						<MenuItem Header="Крупные значки"/>
						<MenuItem Header="Обычные значки"/>
						<MenuItem Header="Мелкие значки"/>
						<MenuItem Header="Список"/>
						<MenuItem Header="Плитка"/>
						<MenuItem Header="Таблица"/>
						<MenuItem Header="Содержимое"/>
					</MenuItem>
					<MenuItem Header="Сортировка">
						<MenuItem Header="Имя"/>
						<MenuItem Header="Дата изменения"/>
						<MenuItem Header="Тип"/>
						<MenuItem Header="Размер"/>
						<MenuItem Header="По возрастанию"/>
						<MenuItem Header="По убыванию"/>
					</MenuItem>
					<MenuItem Header="Группировка"/>
					<MenuItem Header="Свойства"/>
				</ContextMenu>
			</ListBox.ContextMenu>
			
			<ListBox.Resources>
				<local:FileEntityToImageConverter x:Key="FileEntityResource"/>
			</ListBox.Resources>			
			
			<ListBox.ItemTemplate>
				<DataTemplate>					
					<StackPanel Orientation="Vertical" Width="80" Height="100">
						<StackPanel.ContextMenu>
							<ContextMenu>
								<MenuItem Header="Вырезать"/>
								<MenuItem Header="Копировать"/>
								<MenuItem Header="Удалить" 
										  Command="{Binding CurrentDirectoryItem.DeleteCommand}"
										  CommandParameter="{Binding CurrentDirectoryItem.SelectFileEntity}"/>
								<MenuItem Header="Переименовать"/>
								<MenuItem Header="Свойства"/>
							</ContextMenu>
						</StackPanel.ContextMenu>
						<DrawingPresenter Drawing="{Binding ., 
										  Converter={StaticResource FileEntityResource}}"
										  Width="70" Height="70"
										  HorizontalAlignment="Center">
						</DrawingPresenter>
						<Border CornerRadius="7">
							<Border.Background>
								<SolidColorBrush Color="White" Opacity="0.7"/>
							</Border.Background>
							<TextBlock Width="50" Text="{Binding Name}" TextWrapping="Wrap"
									 TextAlignment="Center" VerticalAlignment="Bottom"
									 FontSize="11" FontWeight="Bold">							
							</TextBlock>
						</Border>
					</StackPanel>					
				</DataTemplate>
			</ListBox.ItemTemplate>
			
			<ListBox.ItemsPanel>
				<ItemsPanelTemplate>
					<WrapPanel Orientation="Horizontal"/>
				</ItemsPanelTemplate>
			</ListBox.ItemsPanel>
		</ListBox>
		
	</Grid>	
</Window>
